<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>Socket.IO chat</title>
    <link rel="stylesheet" href="../css/login.css">
  </head>
  <body>
    <div id="menu">
      <button onclick="createRoom()">Create Room</button>
      <button onclick="showJoinForm()">Join Room</button>
  </div>

  <div id="joinForm" style="display: none;">
      <input type="text" id="roomInput" placeholder="Enter Room ID">
      <button onclick="joinRoom()">Join</button>
  </div>

  <div id="roomInfo"></div>

  
    <section id="keyboard">        
    </section>
    <script src="/socket.io/socket.io.js"></script>
    <script>
      const socket = io();
      let currentRoomId = null;

      function createRoom() {
          socket.emit('createRoom');
      }

      function showJoinForm() {
          document.getElementById('joinForm').style.display = 'block';
      }

      function joinRoom() {
          const roomId = document.getElementById('roomInput').value.trim();
          if (roomId) {
              socket.emit('joinRoom', roomId);
              window.location.href = `/game?room=${roomId}`;
          } else {
              alert('Please enter a room ID');
          }
      }

      function startGame() {
          if (currentRoomId) {
              socket.emit('startGame', currentRoomId);
            }
          }

      socket.on('roomCreated', (roomId) => {
        currentRoomId = roomId;
        document.getElementById('roomInfo').innerHTML = `
        Room created! Share this ID with your friends: ${roomId}
        <br>
        <button onclick="startGame()">Start Game</button>
          `;
          document.getElementById('menu').style.display = 'none';
        });

      socket.on('joinedRoom', (roomId) => {
          currentRoomId = roomId;
          document.getElementById('roomInfo').innerHTML = 'Joined room! Waiting for game to start...';
          document.getElementById('menu').style.display = 'none';
          document.getElementById('joinForm').style.display = 'none';
      });

      socket.on('gameStarted', (gameState) => {
          if (currentRoomId) {
              window.location.href = `/game?room=${currentRoomId}`;
          }
      });

      socket.on('gameState', (gameState) => {
          if (currentRoomId) {
            window.location.href = `/game?room=${currentRoomId}`;
          }
      });
      
      socket.on('playerJoined', (data) => {
          console.log(`New player joined. Total players: ${data.playerCount}`);
      });

      socket.on('playerLeft', (data) => {
          console.log(`Player left. Remaining players: ${data.playerCount}`);
      });

      socket.on('error', (message) => {
          alert(message);
      });
  </script>
  <script src="../js/socket.client.js"></script>
  <script src="../js/keyboard.js"></script>
  </body>
</html>